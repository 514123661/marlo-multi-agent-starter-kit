![CrowdAI-Logo](https://github.com/crowdAI/crowdai/raw/master/app/assets/images/misc/crowdai-logo-smile.svg?sanitize=true)
# marlo-single-agent-starter-kit

[![gitter-badge](https://badges.gitter.im/Microsoft/malmo.png)](https://gitter.im/Microsoft/malmo)   

![FindTheGoal](https://media.giphy.com/media/1gWkQbDsHOfo4kZXZv/giphy.gif)

Instructions to participate in the first round of the [MarLo challenge](https://www.crowdai.org/challenges/marlo-2018). 

The task is to submit an agent which can maximise the cumulative reward in the [FindTheGoal-v0](https://marlo.readthedocs.io/en/latest/marlo.envs.FindTheGoal.main.html#module-marlo.envs.FindTheGoal.main) environment in [MarLo](https://marlo.readthedocs.io).

Participants will have to submit their code, with packaging specifications, and the evaluator will automatically build a docker image and execute their agent against different instantiations of the `FindTheGoal` environment.

### <a name="local_build"></a> Local Debugging

Instructions for building and testing the image locally.   

#### <a name="deps"></a> Install Dependencies
* **docker** : By following the instructions [here](https://docs.docker.com/install/linux/docker-ce/ubuntu/)
* **nvidia-docker** : By following the instructions [here](https://github.com/nvidia/nvidia-docker/wiki/Installation-(version-2.0))
* **repo2docker**
```sh
pip install crowdai-repo2docker
```
* **Anaconda** (By following instructions [here](https://www.anaconda.com/download)) 
* **malmo and marlo**
```sh 
conda create python=3.6 --name marlo
conda config --add channels conda-forge
conda activate marlo # or `source activate marlo` depending on your conda version
conda install -c crowdai malmo
pip install -U marlo

# Test installation by :
python -c "import marlo"
python -c "from marlo import MalmoPython"
```
* **Your code specific dependencies**
```sh
# If say you want to install PyTorch
conda install pytorch torchvision -c pytorch
```

#### Clone repository 
```
git clone git@github.com:crowdAI/marlo-single-agent-starter-kit.git
cd marlo-single-agent-starter-kit
```

#### Package your software environment
You can specify your software environment by using all the [available configuration options of repo2docker](https://repo2docker.readthedocs.io/en/latest/config_files.html). (But please remember to use [crowdai-repo2docker](https://pypi.org/project/crowdai-repo2docker/) to have GPU support)   

The recommended way is to use Anaconda configuration files using **environment.yml** files.

```sh 
# The included environment.yml is generated by the command below, and you do not need to run it again 
# if you did not add any custom dependencies

conda env export --no-build > environment.yml

# Note the `--no-build` flag, which is important if you want your anaconda env to be replicable across all 
```

#### Code Entrypoint
The evaluator will use `/home/crowdai/run.sh` as the entrypoint, so please remember to have a `run.sh` at the root, which can instantitate any necessary environment variables, and also start executing your actual code. This repository includes a sample `run.sh` file.

#### Build docker image
As mentioned previously, the entrypoint for the code will be `/home/crowdai/run.sh`; and the the evaluator expects the principal user of the container to be called as `crowdai`, and the home directory at `/home/crowdai/`.

```
export IMAGE_NAME="marlo_agent"

crowdai-repo2docker --no-run \
  --user-id 1001 \
  --user-name crowdai \
  --image-name ${IMAGE_NAME} \
  --debug .
```
This should take some time, but it will build a docker image out of the this repository

# Author
Sharada Mohanty <https://twitter.com/MeMohanty>
